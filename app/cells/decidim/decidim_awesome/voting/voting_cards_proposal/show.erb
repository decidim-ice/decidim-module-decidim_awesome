<div class="<%= container_classes %>">
  <% if show_title? %>
    <h4 class="heading4 vote-title mb-2" style="font-size:1.375rem;"><%= title %></h4>
  <% end %>

  <div class="<%= from_proposals_list ? "vote-cards-container" : "flex flex-row justify-center gap-1.5 mt-4" %>">
    <% [3, 2, 1].each do |weight| %>
      <%= vote_block_for(proposal, weight) %>
    <% end %>
  </div>

  <% if from_proposals_list %>
    <div class="vote-actions-container">
  <% end %>

  <% if component_settings.voting_cards_show_abstain? %>
    <%= action_authorized_link_to(
      :vote,
      proposal_vote_path(0),
      link_options(0).merge(
        {
          title: t("decidim.decidim_awesome.voting.voting_cards.voting_for", proposal: sanitized_title, type: proposal.manifest.label_for(0)),
          class: "button button__#{from_proposals_list ? "xs" : "sm"} button__transparent-secondary #{from_proposals_list ? "" : "mb-4"} vote-action abstain-button #{classes_for(0)}"
        }
      )
    ) do %>
      <%= voted_for?(0) ? t("decidim.decidim_awesome.voting.voting_cards.abstained") : proposal.manifest.label_for(0) %>
      <% if proposal_votes(0) > 0 %>
        <span class="abstain-count"><%= proposal_votes(0) %></span>
      <% end %>
    <% end %>
  <% end %>

  <% if voted_for_any? && !current_settings.votes_blocked? %>
    <% if wrap_change_vote? %>
      <p class="text-center" style="margin-bottom:1rem;">
    <% end %>
        <%= action_authorized_link_to :unvote,
                                      t("decidim.decidim_awesome.voting.voting_cards.change_vote"),
                                      proposal_vote_path(current_vote&.weight),
                                      resource: proposal,
                                      remote: true,
                                      method: :delete,
                                      id: "change-vote",
                                      class: "change-vote-button vote-action font-semibold" %>
    <% if wrap_change_vote? %>
      </p>
    <% end %>
  <% elsif proposal.maximum_votes_reached? && !proposal.can_accumulate_votes_beyond_threshold && current_component.participatory_space.can_participate?(current_user) %>
    <p class="<%= from_proposals_list ? "vote-message" : "text-center" %>"><%= t("decidim.proposals.proposals.vote_button.maximum_votes_reached") %></p>
  <% elsif vote_limit_enabled? && remaining_votes_count_for_user <= 0 %>
    <p class="<%= from_proposals_list ? "vote-message" : "text-center" %>"><%= t("decidim.proposals.proposals.vote_button.no_votes_remaining") %></p>
  <% elsif current_settings.votes_blocked? || !current_component.participatory_space.can_participate?(current_user) %>
    <p class="<%= from_proposals_list ? "vote-message" : "text-center" %>"><%= t("decidim.proposals.proposals.vote_button.votes_blocked") %></p>
  <% end %>

  <% if from_proposals_list %>
    </div>
  <% end %>

</div>

<% unless from_proposals_list %>
  <%= render :modal if current_component.settings.voting_cards_show_modal_help %>
<% end %>
