<div class="callout warning"><%= t("caution", scope: "decidim.decidim_awesome.admin.config") %></div>
<div class="row column decidim_awesome-form">
  <% if config_enabled? :proposal_custom_fields %>
    <p class="help-text"><%= t("help.proposal_custom_fields", scope: "decidim.decidim_awesome.admin.config.form") %></p>
    <p class="help-text"><%= t("help.proposal_custom_fields_example", scope: "decidim.decidim_awesome.admin.config.form") %></p>
    <p class="help-text"><%= t("help.proposal_custom_fields_translations", scope: "decidim.decidim_awesome.admin.config.form") %></p>

    <% form.object.proposal_custom_fields&.each do |key, value| %>
      <div class="proposal_custom_fields_container" data-key="<%= key %>">
        <%= render(partial: "decidim/decidim_awesome/admin/config/autoedit_box_label", locals: { var: "proposal_custom_fields", key: key, scope: "proposal_custom_field_#{key}", delete_path: decidim_admin_decidim_awesome.proposal_custom_field_path(key: key) }) %>
        <div id="<%= key %>_public">
          <div><%= "Public fields" %></div>
          <%= hidden_field_tag "#{key}0", value, name: "config[proposal_custom_fields][#{key}]" %>
          <div class="proposal_custom_fields_editor" data-key="proposal_custom_fields">
            <div class="loading-spinner"></div>
          </div>
        </div>

        <div id="<%= key %>_private">
          <div><%= "Private fields" %></div>
          <%= hidden_field_tag "#{key}1", form.object.private_proposal_custom_fields[key] || "[]", name: "config[private_proposal_custom_fields][#{key}]" %>
          <div class="proposal_custom_fields_editor proposal_custom_fields_editor--private" data-key="private_proposal_custom_fields">
            <div class="loading-spinner"></div>
          </div>
        </div>

        <%= render(partial: "decidim/decidim_awesome/admin/config/constraints", locals: { key: "proposal_custom_field_#{key}", constraints: constraints_for("proposal_custom_field_#{key}") }) %>
      </div>
    <% end %>

    <%= link_to t(".new"), decidim_admin_decidim_awesome.proposal_custom_fields_path, method: :post %>

  <% end %>
</div>

<%= javascript_pack_tag "decidim_decidim_awesome_admin_form_exit_warn" %>
